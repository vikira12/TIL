# Verilog 테스트 벤치

# **테스트 벤치가 뭐임?**

**테스트 벤치는 다 설계한 모듈을 검증하기 위한 가상환경**입니다. 다 짠 모듈을 바로 하드웨어로 넣는다면 여러 문제가 생길 수 있기 떄문에 테스트 벤치를 사용하는 것 입니다. 모듈을 설계하는 문법과는 조금 다른 형식을 가지고 있으며 시뮬레이션을 도와주는 문법이 주를 이루고 있습니다. 그중 주로 사용하는 테스트 벤치 용법을 3종류로 나눠서 설명해 보겠습니다.

### **시뮬레이션 제어 용법**

- `timescale : 시뮬레이션의 시간 단위, 정확도를 정의합니다.
- initial : 시뮬레이션 시작시 딱 한번만 실행하는 블록입니다.(초기화 용도로 많이 사용합니다)
- # : 딜레이를 주는 역할을 합니다.

```html
`timescale 1ns / 1ps  // 시간 단위: 1ns, 정밀도: 1ps

initial begin
 // 내용
end

#20 // 내용;
```

### **시스템 테스크**

- $display : 현재 시점의 변수 값을 출력
- $monitor : 변수의 값이 바뀔 때마다 자동으로 그 값을 출력
- $finish : 시뮬레이션 완전히 중지
- $stop : 시뮬레이션 일지중지

```html
$display("Simulation Started at %t", $time); // 시작한 시간 출력

$monitor("At time %t, data_in = %h", $time, data_in); // data_in이 바뀌면 출력

$finish; // 완전히 종료

$stop; // 일시 정지
```

### **파형 저장**

- $dumpfile : 파형을 저장할 파일 지정
- $dumpvars : 어떤 변수를 저장할지 지정

| **dump level** | 변수 범위 |
| --- | --- |
| **0** | 지정한 모듈의 모든 변수 |
| **1** | 지정한 모듈의 변수 |
| **2** | 지정한 모듈과 바로 아래의 모듈의 변수 |

```html
$dumpfile("test_result.vcd"); // test_result라는 파일 생성

$dumpvars(0, tb_example); // tb_example의 0 단계 level에 해당하는 변수를 저장
```

# **마무리**

이렇게 Verilog에서 빼놓을 수 없는 테스트 벤치와 테스트 벤치에 쓰이는 문법에 대해 알아보았습니다. 모듈의 완성을 확인할 수 있는 테스트 벤치를 어렵게 사용하지 않도록 많이 사용되는 문법만 이라도 외워두는 것을 추천합니다. dump level에 해당하는 변수 범위는 작을수록 범위가 커진다는 것도 기억해 두시면 좋겠습니다. 그럼 임베디드의 정복자가 되시길 바라면서 마치겠습니다. 감사합니다.
